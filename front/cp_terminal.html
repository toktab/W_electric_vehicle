<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CP Terminal - EV Charging System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <style>
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.05); }
        .terminal-output { font-family: 'JetBrains Mono', monospace; white-space: pre-wrap; }
    </style>
</head>
<body class="bg-neutral-950 text-neutral-100 min-h-screen" style="font-family: 'Inter', sans-serif;">
    
    <div class="max-w-7xl mx-auto px-4 py-6">
        
        <!-- Header -->
        <header class="flex items-center justify-between mb-6">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-gradient-to-br from-purple-400 to-purple-600 rounded-xl flex items-center justify-center">
                    <span class="iconify text-white" data-icon="lucide:plug-zap" data-width="22" data-height="22"></span>
                </div>
                <div>
                    <span class="text-xl font-bold bg-gradient-to-r from-purple-400 to-blue-400 bg-clip-text text-transparent" id="cp-title">CP Terminal</span>
                    <p class="text-xs text-neutral-500">Access via Docker Attach</p>
                </div>
            </div>
            <a href="index.html" class="glass rounded-full px-4 py-2 hover:bg-white/10 transition-all flex items-center gap-2">
                <span class="iconify text-emerald-400" data-icon="lucide:home" data-width="18" data-height="18"></span>
                <span class="text-sm font-medium">Dashboard</span>
            </a>
        </header>

        <!-- Info Alert -->
        <div class="glass border-blue-500/30 rounded-2xl p-6 mb-6">
            <div class="flex items-start gap-4">
                <div class="w-10 h-10 rounded-xl bg-blue-500/20 flex items-center justify-center flex-shrink-0">
                    <span class="iconify text-blue-400" data-icon="lucide:info" data-width="20" data-height="20"></span>
                </div>
                <div class="flex-1">
                    <h3 class="text-blue-400 font-semibold mb-2">How to Access CP Terminals</h3>
                    <p class="text-neutral-400 text-sm mb-3">Since CPs are created dynamically, use Docker Attach to access their terminals:</p>
                    <div class="space-y-2">
                        <div class="glass rounded-lg p-3 terminal-output text-xs" id="commands">
                            <div class="text-emerald-400 mb-2"># Access CP Engine</div>
                            <div class="text-neutral-300 mb-4">docker attach evcharging_cp_engine_1</div>
                            
                            <div class="text-emerald-400 mb-2"># Access CP Monitor</div>
                            <div class="text-neutral-300 mb-4">docker attach evcharging_cp_monitor_1</div>
                            
                            <div class="text-amber-400 mb-2"># Detach without stopping (important!)</div>
                            <div class="text-neutral-300">Press: Ctrl+P then Ctrl+Q</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Container Status -->
        <div class="glass rounded-2xl p-6">
            <div class="flex items-center gap-3 mb-4">
                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500/20 to-cyan-500/20 flex items-center justify-center">
                    <span class="iconify text-emerald-400" data-icon="lucide:server" data-width="20" data-height="20"></span>
                </div>
                <div>
                    <h2 class="text-base font-semibold text-neutral-200">Running CP Containers</h2>
                    <p class="text-xs text-neutral-500">Click container name to copy command</p>
                </div>
            </div>
            
            <div id="containers-list" class="space-y-2">
                <div class="text-neutral-600 text-sm text-center py-8">Loading containers...</div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="glass rounded-2xl p-6 mt-6">
            <h3 class="text-base font-semibold text-neutral-200 mb-4">Quick Actions</h3>
            <div class="grid grid-cols-2 gap-3">
                <button onclick="openNewTerminal('engine')" class="glass rounded-lg px-4 py-3 hover:bg-emerald-500/10 transition-all flex items-center gap-3">
                    <span class="iconify text-emerald-400" data-icon="lucide:terminal" data-width="20" data-height="20"></span>
                    <div class="text-left">
                        <div class="text-sm font-medium">Open Engine</div>
                        <div class="text-xs text-neutral-500">In new terminal</div>
                    </div>
                </button>
                <button onclick="openNewTerminal('monitor')" class="glass rounded-lg px-4 py-3 hover:bg-blue-500/10 transition-all flex items-center gap-3">
                    <span class="iconify text-blue-400" data-icon="lucide:activity" data-width="20" data-height="20"></span>
                    <div class="text-left">
                        <div class="text-sm font-medium">Open Monitor</div>
                        <div class="text-xs text-neutral-500">In new terminal</div>
                    </div>
                </button>
            </div>
        </div>

    </div>

    <script>
        const urlParams = new URLSearchParams(window.location.search);
        const cpId = urlParams.get('cp') || 'CP-001';
        const cpNum = cpId.split('-')[1];
        
        document.getElementById('cp-title').textContent = `${cpId} Terminal`;
        
        // Update commands with correct CP number
        document.getElementById('commands').innerHTML = `
            <div class="text-emerald-400 mb-2"># Access CP Engine</div>
            <div class="text-neutral-300 mb-4 cursor-pointer hover:text-emerald-400 transition" onclick="copyCommand(this)">docker attach evcharging_cp_engine_${cpNum}</div>
            
            <div class="text-emerald-400 mb-2"># Access CP Monitor</div>
            <div class="text-neutral-300 mb-4 cursor-pointer hover:text-emerald-400 transition" onclick="copyCommand(this)">docker attach evcharging_cp_monitor_${cpNum}</div>
            
            <div class="text-amber-400 mb-2"># Detach without stopping (important!)</div>
            <div class="text-neutral-300">Press: Ctrl+P then Ctrl+Q</div>
        `;
        
        function copyCommand(element) {
            const command = element.textContent;
            navigator.clipboard.writeText(command).then(() => {
                const original = element.textContent;
                element.textContent = 'âœ“ Copied!';
                element.classList.add('text-emerald-400');
                setTimeout(() => {
                    element.textContent = original;
                    element.classList.remove('text-emerald-400');
                }, 2000);
            });
        }
        
        function openNewTerminal(type) {
            const containerName = type === 'engine' 
                ? `evcharging_cp_engine_${cpNum}` 
                : `evcharging_cp_monitor_${cpNum}`;
            
            // Copy command to clipboard
            const command = `docker attach ${containerName}`;
            navigator.clipboard.writeText(command);
            
            // Show notification
            alert(`Command copied to clipboard!\n\n${command}\n\nPaste this in your terminal to access the ${type}.`);
        }
        
        async function loadContainers() {
            const list = document.getElementById('containers-list');
            list.innerHTML = `
                <div class="glass rounded-lg p-4 hover:bg-white/5 transition cursor-pointer" onclick="copyCommand(this.querySelector('.command'))">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg bg-purple-500/20 flex items-center justify-center">
                                <span class="iconify text-purple-400" data-icon="lucide:cpu" data-width="16" data-height="16"></span>
                            </div>
                            <div>
                                <div class="font-medium text-sm">evcharging_cp_engine_${cpNum}</div>
                                <div class="text-xs text-neutral-500">CP Engine Container</div>
                            </div>
                        </div>
                        <div class="text-xs text-neutral-500 command">docker attach evcharging_cp_engine_${cpNum}</div>
                    </div>
                </div>
                
                <div class="glass rounded-lg p-4 hover:bg-white/5 transition cursor-pointer" onclick="copyCommand(this.querySelector('.command'))">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center gap-3">
                            <div class="w-8 h-8 rounded-lg bg-blue-500/20 flex items-center justify-center">
                                <span class="iconify text-blue-400" data-icon="lucide:activity" data-width="16" data-height="16"></span>
                            </div>
                            <div>
                                <div class="font-medium text-sm">evcharging_cp_monitor_${cpNum}</div>
                                <div class="text-xs text-neutral-500">CP Monitor Container</div>
                            </div>
                        </div>
                        <div class="text-xs text-neutral-500 command">docker attach evcharging_cp_monitor_${cpNum}</div>
                    </div>
                </div>
            `;
        }
        
        loadContainers();
    </script>
</body>
</html>